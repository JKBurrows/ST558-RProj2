---
title: "ST558 R Project II"
author: "Mana Azizsoltani"
date: "October 16, 2020"
output: rmarkdown::github_document
---

```{r setup, include=FALSE, message=FALSE}
# Set seed for reproducibility
set.seed(445)

# Load necessary libraries
library(knitr)
library(caret)
library(tidyverse)
library(class)
library(randomForest)
library(gbm)
library(corrplot)
library(klaR)
```

# Introduction

# Data
```{r, message=FALSE}
# Read in data set
dat <- read_csv("OnlineNewsPopularity.csv")
dat <- dat %>% select(-url)
mon <- dat %>% filter(weekday_is_monday == 1) %>% select(-starts_with("weekday_is_"))

# Try and weed out correlated variables
C <- cor(mon)
```

# Modeling

```{r}
index <- createDataPartition(mon$shares, p = .7, list = F) %>% as.vector()
train <- mon[index,]
test <- mon[-index,]

# Specify CV method
trctrl <- trainControl(method = "cv", number = 5)

# Fit Random Forest
rf <- train(shares ~., data = test, method = "rf",
            trControl=trctrl, preProcess = c("center", "scale"),
            verbose = FALSE, tuneGrid = data.frame(mtry = 20),
            importance = TRUE)
pred <- predict(rf, newdata = train[1:400,])
postResample(pred, train[1:400,]$shares)
rf
```

